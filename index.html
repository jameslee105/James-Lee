<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>James Lee</title>
  <link rel="stylesheet" href="styles.css?v=1.2" />
</head>

<body>
  <div id="loading-spinner" style="display:none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    font-family: 'Work Sans', sans-serif; font-size: 18px; color: #444;">
    Loading...
  </div>
  <header></header>

  <div class="nav-wrapper">
    <button class="mobile-nav-toggle" aria-label="Toggle navigation">&#9776;</button> <!-- â˜° icon -->
    <nav class="nav-bar nav-animate">
      <a href="home.html" data-link>HOME</a>
      <a href="about.html" data-link>ABOUT</a>
      <a href="scores.html" data-link>SCORES</a>
      <a href="contact.html" data-link>CONTACT</a>
    </nav>
    <hr class="divider div-animate" />
  </div>
  

  <main id="content"></main>

  <footer>
    <span>leejame105@gmail.com</span>
    <span style="margin: 0 10px; color: #888;">|</span>
    <a href="https://youtube.com/@cloudtrainodyssey?si=iqb1--WOzuudZ52f" target="_blank">
      <img src="photo/youtube_logo.png" alt="YouTube" class="linkedin-icon" />
    </a>
    <span style="margin: 0 10px; color: #888;">|</span>
    <a href="https://www.instagram.com/cloudtrain_odyssey?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank">
      <img src="photo/Instagram_icon.png" alt="Instagram" class="linkedin-icon" />
    </a>
  </footer>
  
<script>
  const mobileToggle = document.querySelector('.mobile-nav-toggle');
const navBar = document.querySelector('.nav-bar');

mobileToggle.addEventListener('click', () => {
  navBar.classList.toggle('active');
});

  async function loadContent(url) {
    const content = document.getElementById('content');
    content.classList.add('fade-out');
    await new Promise(resolve => setTimeout(resolve, 400));

    try {
      const response = await fetch(url);
      const html = await response.text();
      const temp = document.createElement('div');
      temp.innerHTML = html;

      const newContent = temp.querySelector('#page-content');
      if (newContent) {
        content.innerHTML = newContent.innerHTML;
        const scrollBehavior = window.innerWidth < 768 ? 'auto' : 'smooth';
        window.scrollTo({ top: 0, behavior: scrollBehavior });


        content.classList.remove('fade-out');
        content.style.animation = 'none';
        void content.offsetWidth;
        content.style.animation = null;

        document.querySelectorAll('script[data-dynamic]').forEach(s => s.remove());

        if (url.includes("scores.html")) {
          const wavesurferScript = document.createElement("script");
          wavesurferScript.src = "https://unpkg.com/wavesurfer.js";
          wavesurferScript.setAttribute("data-dynamic", "true");
          wavesurferScript.onload = () => {
            const customScript = document.createElement("script");
            customScript.src = "scores.js";
            customScript.setAttribute("data-dynamic", "true");
            const query = new URL(url, window.location.href).search;
            window.__SONG_ID__ = query;
            document.body.appendChild(customScript);
          };
          document.body.appendChild(wavesurferScript);
}
      } else {
        content.innerHTML = "<p>Page format is incorrect.</p>";
      }
    } catch (err) {
      content.innerHTML = "<p>Failed to load page.</p>";
      console.error(err);
    }
  }
  let firstLoad = true;

  window.addEventListener("DOMContentLoaded", () => {
    loadContent("home.html", true);
  });

  document.addEventListener('click', e => {
  const link = e.target.closest('a[data-link]');
  if (!link) return;

  e.preventDefault();

  const fullUrl = new URL(link.href, window.location.href);
  const pathWithQuery = fullUrl.pathname + fullUrl.search;

  history.pushState(null, '', pathWithQuery);
  loadContent(pathWithQuery); 
});
window.addEventListener('popstate', () => {
  loadContent(location.pathname + location.search);
});


  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert("LinkedIn address has copied.");
    });
  }
</script>
</body>
</html>
